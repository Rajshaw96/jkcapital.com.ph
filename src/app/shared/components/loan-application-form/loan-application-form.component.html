<section class="loan-wrapper">
  <div class="container">
    <div class="section-header">
      <span class="section-line"></span>
      <h2>Loan Application</h2>
      <p class="subtitle">
        Apply for loans effortlessly with quick approvals and flexible repayment options.
      </p>
    </div>
  </div>

  <div class="loan-container">
    <div class="loan-form-card">

      <h2>Loan Application Form</h2>

      <form [formGroup]="loanForm" (ngSubmit)="submit()" novalidate>

        <!-- ðŸ”´ TOP FORM ERROR (NEW) -->
        <p class="error-text" *ngIf="submitted && loanForm.invalid">
          Please fix the highlighted fields before submitting the form.
        </p>

        <!-- BASIC DETAILS -->
        <div class="form-row">
          <div class="form-group">
            <label>First Name *</label>
            <input formControlName="firstName" placeholder="e.g. John" />
            <p class="error-text" *ngIf="isInvalid('firstName')">
              First name is required (min 2 characters)
            </p>
          </div>

          <div class="form-group">
            <label>Last Name *</label>
            <input formControlName="lastName" placeholder="e.g. Doe" />
            <p class="error-text" *ngIf="isInvalid('lastName')">
              Last name is required (min 2 characters)
            </p>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Email Address *</label>
            <input formControlName="email" placeholder="e.g. john@doe.com" />
            <p class="error-text" *ngIf="isInvalid('email')">
              Please enter a valid email address
            </p>
          </div>

          <div class="form-group">
            <label>Contact Number *</label>
            <input formControlName="contactNumber" placeholder="+63 900 000 0000" />
            <p class="error-text" *ngIf="isInvalid('contactNumber')">
              Please enter a valid contact number
            </p>
          </div>
        </div>

        <div class="form-group">
          <label>Business Name</label>
          <input formControlName="businessName" />
        </div>

        <div class="form-group">
          <label>Business Address</label>
          <input formControlName="businessAddress" />
        </div>

        <div class="form-group">
          <label>Which province is your business located in? *</label>
          <select formControlName="province">
            <option value="">Select region / province</option>
            <option>Metro Manila</option>
            <option>Cebu</option>
            <option>Davao</option>
          </select>
          <p class="error-text" *ngIf="isInvalid('province')">
            Province is required
          </p>
        </div>

        <div class="form-group">
          <label>Residence Address</label>
          <input formControlName="residenceAddress" />
        </div>

        <!-- BUSINESS DETAILS -->
        <div class="form-row">
          <div class="form-group">
            <label>Business Classification *</label>
            <select formControlName="businessClassification">
              <option value="">Select option</option>
              <option>Sole Proprietorship</option>
              <option>Partnership</option>
              <option>Corporation</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('businessClassification')">
              Required
            </p>
          </div>

          <div class="form-group">
            <label>Nature of Business *</label>
            <select formControlName="businessNature">
              <option value="">Select option</option>
              <option>Manufacturing</option>
              <option>Retail</option>
              <option>Services</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('businessNature')">
              Required
            </p>
          </div>
        </div>

        <div class="form-group">
          <label>Product or Service *</label>
          <input formControlName="productService" />
          <p class="error-text" *ngIf="isInvalid('productService')">
            Required
          </p>
        </div>

        <!-- BANK DETAILS -->
        <div class="form-row">
          <div class="form-group">
            <label>Do you have a bank account? *</label>
            <div class="radio-group">
              <label><input type="radio" value="yes" formControlName="hasBankAccount"> Yes</label>
              <label><input type="radio" value="no" formControlName="hasBankAccount"> No</label>
            </div>
            <p class="error-text" *ngIf="isInvalid('hasBankAccount')">
              Please select an option
            </p>
          </div>

          <div class="form-group">
            <label>How old is your bank account?</label>
            <select formControlName="bankAccountAge">
              <option value="">Select option</option>
              <option>Less than 1 year</option>
              <option>1â€“3 years</option>
              <option>3+ years</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('bankAccountAge')">
              Required if bank account exists
            </p>
          </div>
        </div>

        <div class="form-group">
          <label>Average Daily Balance</label>
          <select formControlName="avgDailyBalance">
            <option value="">Select option</option>
            <option>Below 50K</option>
            <option>50K â€“ 200K</option>
            <option>200K+</option>
          </select>
        </div>

        <!-- LOAN DETAILS -->
        <div class="form-row">
          <div class="form-group">
            <label>Loan Product *</label>
            <select formControlName="loanProduct">
              <option value="">Select option</option>
              <option>Business Loan</option>
              <option>Credit Line</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('loanProduct')">
              Required
            </p>
          </div>

          <div class="form-group">
            <label>Loan Purpose *</label>
            <select formControlName="loanPurpose">
              <option value="">Purpose for funding</option>
              <option>Expansion</option>
              <option>Working Capital</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('loanPurpose')">
              Required
            </p>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Loan Amount *</label>
            <input formControlName="loanAmount" />
            <p class="error-text" *ngIf="isInvalid('loanAmount')">
              Enter a valid loan amount
            </p>
          </div>

          <div class="form-group">
            <label>Loan Term *</label>
            <select formControlName="loanTerm">
              <option value="">Select option</option>
              <option>6 months</option>
              <option>12 months</option>
              <option>24 months</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('loanTerm')">
              Required
            </p>
          </div>
        </div>

        <div class="form-group">
          <label>Annual Net Income *</label>
          <select formControlName="annualIncome">
            <option value="">Select option</option>
            <option>Below 1M</option>
            <option>1M â€“ 5M</option>
            <option>5M+</option>
          </select>
          <p class="error-text" *ngIf="isInvalid('annualIncome')">
            Required
          </p>
        </div>

        <!-- COLLATERAL -->
        <div class="form-row">
          <div class="form-group">
            <label>Provide Collateral? *</label>
            <div class="radio-group">
              <label><input type="radio" value="yes" formControlName="provideCollateral"> Yes</label>
              <label><input type="radio" value="no" formControlName="provideCollateral"> No</label>
            </div>
            <p class="error-text" *ngIf="isInvalid('provideCollateral')">
              Required
            </p>
          </div>

          <div class="form-group">
            <label>Collateral Type</label>
            <select formControlName="collateralType">
              <option value="">Select option</option>
              <option>Property</option>
              <option>Vehicle</option>
              <option>Equipment</option>
            </select>
            <p class="error-text" *ngIf="isInvalid('collateralType')">
              Required if collateral is provided
            </p>
          </div>
        </div>

        <!-- ðŸ”˜ SUBMIT BUTTON (UPDATED ONLY LOGIC) -->
        <button
          type="submit"
          class="submit-btn"
          [disabled]="loading"
        >
          {{ loading ? 'Submitting...' : 'Submit Now' }}
        </button>

      </form>
    </div>
  </div>
</section>
